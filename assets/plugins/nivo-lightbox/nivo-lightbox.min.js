/*
* Nivo Lightbox v1.2.0
* A fork of the original Nivo Lightbox
* https://github.com/jerivas/Nivo-Lightbox#readme
*
* Copyright 2016, Ed Rivas <e@jerivas.com>
* Free to use and abuse under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
*/

!function(a,b,c,d){function e(b,c){this.el=b,this.$el=a(this.el),this.options=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="nivoLightbox",g={effect:"fade",theme:"default",keyboardNav:!0,clickOverlayToClose:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(a){},beforeHideLightbox:function(){},afterHideLightbox:function(){},onPrev:function(a){},onNext:function(a){},errorMessage:"The requested content cannot be loaded. Please try again later."};e.prototype={init:function(){var b=this;a("html").hasClass("nivo-lightbox-notouch")||a("html").addClass("nivo-lightbox-notouch"),"ontouchstart"in c&&a("html").removeClass("nivo-lightbox-notouch"),this.$el.on("click",function(a){b.showLightbox(a)}),this.options.keyboardNav&&a("body").off("keyup").on("keyup",function(c){var d=c.keyCode?c.keyCode:c.which;27==d&&b.destructLightbox(),37==d&&a(".nivo-lightbox-prev").trigger("click"),39==d&&a(".nivo-lightbox-next").trigger("click")}),this.options.onInit.call(this)},showLightbox:function(b){var c=this,d=this.$el,e=this.checkContent(d);if(e){b.preventDefault(),this.options.beforeShowLightbox.call(this);var f=this.constructLightbox();if(f){var g=f.find(".nivo-lightbox-content");if(g){if(a("body").addClass("nivo-lightbox-body-effect-"+this.options.effect),this.processContent(g,d),this.$el.attr("data-lightbox-gallery")){var h=a('[data-lightbox-gallery="'+this.$el.attr("data-lightbox-gallery")+'"]');a(".nivo-lightbox-nav").show(),a(".nivo-lightbox-prev").off("click").on("click",function(b){b.preventDefault();var e=h.index(d);d=h.eq(e-1),a(d).length||(d=h.last()),c.processContent(g,d),c.options.onPrev.call(this,[d])}),a(".nivo-lightbox-next").off("click").on("click",function(b){b.preventDefault();var e=h.index(d);d=h.eq(e+1),a(d).length||(d=h.first()),c.processContent(g,d),c.options.onNext.call(this,[d])})}setTimeout(function(){f.addClass("nivo-lightbox-open"),c.options.afterShowLightbox.call(this,[f])},1)}}}},checkContent:function(a){var b=a.attr("href"),c=b.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);return null!==b.match(/\.(jpeg|jpg|gif|png)$/i)?!0:c?!0:"ajax"==a.attr("data-lightbox-type")?!0:"#"==b.substring(0,1)&&"inline"==a.attr("data-lightbox-type")?!0:"iframe"==a.attr("data-lightbox-type")?!0:!1},processContent:function(c,d){var e=this,f=d.attr("href"),g=f.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);if(c.html("").addClass("nivo-lightbox-loading"),this.isHidpi()&&d.attr("data-lightbox-hidpi")&&(f=d.attr("data-lightbox-hidpi")),null!==f.match(/\.(jpeg|jpg|gif|png)$/i)){var h=a("<img>",{src:f});h.one("load",function(){var d=a('<div class="nivo-lightbox-image" />');d.append(h),c.html(d).removeClass("nivo-lightbox-loading"),d.css({"line-height":a(".nivo-lightbox-content").height()+"px",height:a(".nivo-lightbox-content").height()+"px"}),a(b).resize(function(){d.css({"line-height":a(".nivo-lightbox-content").height()+"px",height:a(".nivo-lightbox-content").height()+"px"})})}).each(function(){this.complete&&a(this).load()}),h.error(function(){var b=a('<div class="nivo-lightbox-error"><p>'+e.options.errorMessage+"</p></div>");c.html(b).removeClass("nivo-lightbox-loading")})}else if(g){var i="",j="nivo-lightbox-video";if("youtube"==g[1]&&(i="http://www.youtube.com/embed/"+g[4],j="nivo-lightbox-youtube"),"youtu"==g[1]&&(i="http://www.youtube.com/embed/"+g[3],j="nivo-lightbox-youtube"),"vimeo"==g[1]&&(i="http://player.vimeo.com/video/"+g[3],j="nivo-lightbox-vimeo"),i){var k=a("<iframe>",{src:i,"class":j,frameborder:0,vspace:0,hspace:0,scrolling:"auto"});c.html(k),k.load(function(){c.removeClass("nivo-lightbox-loading")})}}else if("ajax"==d.attr("data-lightbox-type"))a.ajax({url:f,cache:!1,success:function(d){var e=a('<div class="nivo-lightbox-ajax" />');e.append(d),c.html(e).removeClass("nivo-lightbox-loading"),e.outerHeight()<c.height()&&e.css({position:"relative",top:"50%","margin-top":-(e.outerHeight()/2)+"px"}),a(b).resize(function(){e.outerHeight()<c.height()&&e.css({position:"relative",top:"50%","margin-top":-(e.outerHeight()/2)+"px"})})},error:function(){var b=a('<div class="nivo-lightbox-error"><p>'+e.options.errorMessage+"</p></div>");c.html(b).removeClass("nivo-lightbox-loading")}});else if("#"==f.substring(0,1)&&"inline"==d.attr("data-lightbox-type"))if(a(f).length){var l=a('<div class="nivo-lightbox-inline" />');l.append(a(f).clone().show()),c.html(l).removeClass("nivo-lightbox-loading"),l.outerHeight()<c.height()&&l.css({position:"relative",top:"50%","margin-top":-(l.outerHeight()/2)+"px"}),a(b).resize(function(){l.outerHeight()<c.height()&&l.css({position:"relative",top:"50%","margin-top":-(l.outerHeight()/2)+"px"})})}else{var m=a('<div class="nivo-lightbox-error"><p>'+e.options.errorMessage+"</p></div>");c.html(m).removeClass("nivo-lightbox-loading")}else{if("iframe"!=d.attr("data-lightbox-type"))return!1;var n=a("<iframe>",{src:f,"class":"nivo-lightbox-item",frameborder:0,vspace:0,hspace:0,scrolling:"auto"});c.html(n),n.load(function(){c.removeClass("nivo-lightbox-loading")})}if(d.attr("title")){var o=a("<span>",{"class":"nivo-lightbox-title"});o.text(d.attr("title")),a(".nivo-lightbox-title-wrap").html(o)}else a(".nivo-lightbox-title-wrap").html("")},constructLightbox:function(){if(a(".nivo-lightbox-overlay").length)return a(".nivo-lightbox-overlay");var b=a("<div>",{"class":"nivo-lightbox-overlay nivo-lightbox-theme-"+this.options.theme+" nivo-lightbox-effect-"+this.options.effect}),c=a("<div>",{"class":"nivo-lightbox-wrap"}),d=a("<div>",{"class":"nivo-lightbox-content"}),e=a('<a href="#" class="nivo-lightbox-nav nivo-lightbox-prev">Previous</a><a href="#" class="nivo-lightbox-nav nivo-lightbox-next">Next</a>'),f=a('<a href="#" class="nivo-lightbox-close" title="Close">Close</a>'),g=a("<div>",{"class":"nivo-lightbox-title-wrap"}),h=0;h&&b.addClass("nivo-lightbox-ie"),c.append(d),c.append(g),b.append(c),b.append(e),b.append(f),a("body").append(b);var i=this;return i.options.clickOverlayToClose&&b.on("click",function(b){(b.target===this||a(b.target).hasClass("nivo-lightbox-content")||a(b.target).hasClass("nivo-lightbox-image"))&&i.destructLightbox()}),f.on("click",function(a){a.preventDefault(),i.destructLightbox()}),b},destructLightbox:function(){var b=this;this.options.beforeHideLightbox.call(this),a(".nivo-lightbox-overlay").removeClass("nivo-lightbox-open"),a(".nivo-lightbox-nav").hide(),a("body").removeClass("nivo-lightbox-body-effect-"+b.options.effect);var c=0;c&&(a(".nivo-lightbox-overlay iframe").attr("src"," "),a(".nivo-lightbox-overlay iframe").remove()),a(".nivo-lightbox-prev").off("click"),a(".nivo-lightbox-next").off("click"),a(".nivo-lightbox-content").empty(),this.options.afterHideLightbox.call(this)},isHidpi:function(){var a="(-webkit-min-device-pixel-ratio: 1.5),                              (min--moz-device-pixel-ratio: 1.5),                              (-o-min-device-pixel-ratio: 3/2),                              (min-resolution: 1.5dppx)";return b.devicePixelRatio>1?!0:b.matchMedia&&b.matchMedia(a).matches?!0:!1}},a.fn[f]=function(b){return this.each(function(){a.data(this,f)||a.data(this,f,new e(this,b))})}}(jQuery,window,document);